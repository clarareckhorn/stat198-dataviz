# Data
isoflurane   <- c(.28, .51, 1.00, .39, .29, .36, .32, .69, .17, .33)
halothane    <- c(.30, .39, .63, .68, .38, .21, .88, .39, .51, .32)
cyclopropane <- c(1.07, 1.35, .69, .28, 1.24, 1.53, .49, .56, 1.02, .30)
dog <- factor(1:10)
df <- data.frame(
dog = dog,
isoflurane = isoflurane,
halothane = halothane,
cyclopropane = cyclopropane
)
df_long <- reshape(
df,
varying = list(names(df)[2:4]),
v.names = "concentration",
timevar = "treatment",
times = c("Isoflurane", "Halothane", "Cyclopropane"),
direction = "long"
)
df_long$treatment <- factor(df_long$treatment)
par(mfrow=c(1,3))
qqnorm(isoflurane, main="Isoflurane QQ Plot"); qqline(isoflurane)
qqnorm(halothane, main="Halothane QQ Plot"); qqline(halothane)
qqnorm(cyclopropane, main="Cyclopropane QQ Plot"); qqline(cyclopropane)
boxplot(concentration ~ treatment, data=df_long,
main="Boxplots of Epinephrine Levels by Treatment",
ylab="Concentration (ng/mL)")
aov_model <- aov(concentration ~ treatment + Error(dog/treatment), data=df_long)
summary(aov_model)
aov_model <- aov(concentration ~ treatment + Error(dog/treatment), data=df_long)
summary(aov_model)
# Data
isoflurane   <- c(.28, .51, 1.00, .39, .29, .36, .32, .69, .17, .33)
halothane    <- c(.30, .39, .63, .68, .38, .21, .88, .39, .51, .32)
cyclopropane <- c(1.07, 1.35, .69, .28, 1.24, 1.53, .49, .56, 1.02, .30)
dog <- factor(1:10)
df <- data.frame(
dog = dog,
isoflurane = isoflurane,
halothane = halothane,
cyclopropane = cyclopropane
)
df_long <- reshape(
df,
varying = list(names(df)[2:4]),
v.names = "concentration",
timevar = "treatment",
times = c("Isoflurane", "Halothane", "Cyclopropane"),
direction = "long"
)
df_long$treatment <- factor(df_long$treatment)
aov_model <- aov(concentration ~ treatment + Error(dog/treatment), data=df_long)
summary(aov_model)
friedman.test(as.matrix(df[,2:4]))
getwd()
cd Stat135
setwd("/Users/jocelyneperez/Documents/Stat135")
getwd()
chicks <- read.table("chicks.txt", header = TRUE)
chicks <- read.table("chicks.txt", header = TRUE)
head(chicks)
str(chicks)
# checking to see if I download correctly my Data and checking my data frame
#/Users/jocelyneperez/Documents/stat135
chicks <- read.table("chicks.txt", header = TRUE)
head(chicks)
str(chicks)
x <- chicks$length     # egg length (mm)
y <- chicks$chickwt    # chick weight (g)
# Plot
plot(x, y,
xlab = "Egg length (mm)",
ylab = "Chick weight (g)",
pch = 19,
main = "Chick weight vs Egg length")
x <- chicks$el    # egg length (mm)
y <- chicks$cw # chick weight (g)
# Plot
plot(x, y,
xlab = "Egg length (mm)",
ylab = "Chick weight (g)",
pch = 19,
main = "Chick weight vs Egg length")
# Compute means, SDs, correlation
xbar <- mean(x)
ybar <- mean(y)
sd_x <- sd(x)
sd_y <- sd(y)
r_xy <- cor(x, y)
xbar; ybar; sd_x; sd_y; r_xy
# Manual slope & intercept
b1 <- r_xy * (sd_y / sd_x)
b0 <- ybar - b1 * xbar
b0; b1
# Add regression line
abline(a = b0, b = b1, col = "red", lwd = 2)
#changing the variable name for more descriptive description
names(chicks) <- c("length", "breadth", "eggwt", "chickwt")
x <- chicks$length   # egg length (mm)
y <- chicks$chickwt # chick weight (g)
# Plot
plot(x, y,
xlab = "Egg length (mm)",
ylab = "Chick weight (g)",
pch = 19,
main = "Chick weight vs Egg length")
# Compute means, SDs, correlation
xbar <- mean(x)
ybar <- mean(y)
sd_x <- sd(x)
sd_y <- sd(y)
r_xy <- cor(x, y)
xbar; ybar; sd_x; sd_y; r_xy
# Manual slope & intercept
b1 <- r_xy * (sd_y / sd_x)
b0 <- ybar - b1 * xbar
b0; b1
# Add regression line
abline(a = b0, b = b1, col = "red", lwd = 2)
model <- lm(chickwt ~ length, data = chicks)
summary(model)
#check correlation
cor(chicks[, c("length","breadth","eggwt","chickwt")])
x <- chicks$eggwt
y <- chicks$chickwt
plot(x, y,
xlab = "Egg weight (g)",
ylab = "Chick weight (g)",
pch = 19,
main = "Chick weight vs Egg weight")
# regression line
mod_best <- lm(chickwt ~ eggwt, data = chicks)
abline(mod_best, col = "red", lwd = 2)
x <- chicks$eggwt
y <- chicks$chickwt
plot(x, y,
xlab = "Egg weight (g)",
ylab = "Chick weight (g)",
pch = 19,
main = "Chick weight vs Egg weight")
# regression line
mod_best <- lm(chickwt ~ eggwt, data = chicks)
abline(mod_best, col = "yellow", lwd = 2)
#changing the variable name for more descriptive description
names(chicks) <- c("length", "breadth", "eggwt", "chickwt")
x <- chicks$length   # egg length (mm)
y <- chicks$chickwt # chick weight (g)
# Plot
plot(x, y,
xlab = "Egg length (mm)",
ylab = "Chick weight (g)",
pch = 19,
main = "Chick weight vs Egg length")
# Compute means, sd's
xbar <- mean(x)
ybar <- mean(y)
sd_x <- sd(x)
sd_y <- sd(y)
#correlation
r_xy <- cor(x, y)
xbar; ybar; sd_x; sd_y; r_xy
# Manual slope and intercept
b1 <- r_xy * (sd_y / sd_x)
b0 <- ybar - b1 * xbar
b0; b1
# Add regression line
abline(a = b0, b = b1, col = "lightyellow", lwd = 2)
#changing the variable name for more descriptive description
names(chicks) <- c("length", "breadth", "eggwt", "chickwt")
x <- chicks$length   # egg length (mm)
y <- chicks$chickwt # chick weight (g)
# Plot
plot(x, y,
xlab = "Egg length (mm)",
ylab = "Chick weight (g)",
pch = 19,
main = "Chick weight vs Egg length")
# Compute means, sd's
xbar <- mean(x)
ybar <- mean(y)
sd_x <- sd(x)
sd_y <- sd(y)
#correlation
r_xy <- cor(x, y)
xbar; ybar; sd_x; sd_y; r_xy
# Manual slope and intercept
b1 <- r_xy * (sd_y / sd_x)
b0 <- ybar - b1 * xbar
b0; b1
# Add regression line
abline(a = b0, b = b1, col = "yellow", lwd = 2)
plot(x, resid(mod_best),
xlab = "Egg weight (g)",
ylab = "Residuals",
main = "Residual Plot")
abline(h = 0, lwd = 2, col = "blue")
plot(x, resid(mod_best),
xlab = "Egg weight (g)",
ylab = "Residuals",
main = "Residual Plot")
abline(h = 0, lwd = 2, col = "yellow")
#lecture 29 example
median_length <- median(chicks$length)
group <- ifelse(chicks$length <= median_length, "low", "high")
# Wilcoxon test: chick weight in low vs high egg length
wilcox.test(chickwt ~ group, data = chicks, alternative = "less")
mod <- lm(chickwt ~ eggwt, data = chicks)
summary(mod)
mod <- lm(chickwt ~ eggwt, data = chicks)
summary(mod)
x0 <- 8.5
yhat <- coef(mod)[1] + coef(mod)[2]*x0
x <- chicks$eggwt
n <- length(x)
xbar <- mean(x)
sigma_hat <- summary(mod)$sigma
SE_yhat <- sigma_hat * sqrt(1/n + (x0 - xbar)^2 / sum((x - xbar)^2))
tval <- qt(0.975, df = n-2)
CI_lower <- yhat - tval*SE_yhat
CI_upper <- yhat + tval*SE_yhat
CI_lower
CI_upper
x0 <- 8.5
x <- chicks$eggwt
yhat <- coef(mod)[1] + coef(mod)[2]*x0
n <- length(x)
xbar <- mean(x)
sigma_hat <- summary(mod)$sigma
tval <- qt(0.975, df = n-2)
# Standard error for prediction
SE_pred <- sigma_hat * sqrt(1 + 1/n + (x0 - xbar)^2 / sum((x - xbar)^2))
# Prediction interval
PI_lower <- yhat - tval * SE_pred
PI_upper <- yhat + tval * SE_pred
PI_lower
PI_upper
mod <- lm(chickwt ~ eggwt, data = chicks)
summary(mod)
#specific weight
x0 <- 12
yhat <- coef(mod)[1] + coef(mod)[2]*x0
mod <- lm(chickwt ~ eggwt, data = chicks)
summary(mod)
#specific weight
x0 <- 12
yhat <- coef(mod)[1] + coef(mod)[2]*x0
x <- chicks$eggwt
n <- length(x)
xbar <- mean(x)
sigma_hat <- summary(mod)$sigma
SE_yhat <- sigma_hat * sqrt(1/n + (x0 - xbar)^2 / sum((x - xbar)^2))
mod <- lm(chickwt ~ eggwt, data = chicks)
summary(mod)
#specific weight
x0 <- 12
yhat <- coef(mod)[1] + coef(mod)[2]*x0
x <- chicks$eggwt
n <- length(x)
xbar <- mean(x)
sigma_hat <- summary(mod)$sigma
SE_yhat <- sigma_hat * sqrt(1/n + (x0 - xbar)^2 / sum((x - xbar)^2))
tval <- qt(0.975, df = n-2)
CI_lower <- yhat - tval*SE_yhat
CI_upper <- yhat + tval*SE_yhat
CI_lower
CI_upper
x0 <- 12
x <- chicks$eggwt
yhat <- coef(mod)[1] + coef(mod)[2]*x0
n <- length(x)
xbar <- mean(x)
sigma_hat <- summary(mod)$sigma
tval <- qt(0.975, df = n-2)
# Standard error for prediction
SE_pred <- sigma_hat * sqrt(1 + 1/n + (x0 - xbar)^2 / sum((x - xbar)^2))
# Prediction interval
PI_lower <- yhat - tval * SE_pred
PI_upper <- yhat + tval * SE_pred
PI_lower
PI_upper
mod2 <- lm(chickwt ~ length + breadth, data = chicks)
# Check the output
summary(mod2)
# Regression: egg weight ~ egg length + egg breadth
mod_egg <- lm(eggwt ~ length + breadth, data = chicks)
summary(mod_egg)
mod3 <- lm(chickwt ~ length + breadth + eggwt, data = chicks)
summary(mod3)
chicks <- read.table("tox.txt", header = TRUE)
head(chicks)
str(chicks)
# Column 4 = baseline score
# Column 5 = month15 score
baseline <- tox[,4]
#read table/import table
#large scores are good
tox <- read.table("tox.txt", header = TRUE)
head(chicks)
str(chicks)
# Column 4 = baseline score
# Column 5 = month15 score
baseline <- tox[,4]
after15  <- tox[,5]
# Column 4 = baseline score
# Column 5 = month15 score
baseline <- tox[,4]
after15  <- tox[,5]
qqnorm(after15 - baseline)
qqline(after15 - baseline)
# Boxplots of each group
boxplot(baseline, after15,
names = c("Baseline", "15-month"),
main = "Lung Scores Before and After Treatment")
t.test(after15, baseline,
paired = TRUE,
alternative = "less")
wilcox.test(after15, baseline,
paired = TRUE,
alternative = "less")
full <- lm(tox[,5] ~ tox[,1] + tox[,2] + tox[,3] + tox[,4])
summary(full)
best <- step(full)
summary(best)
full <- lm(tox[,5] ~ tox[,1] + tox[,2] + tox[,3] + tox[,4])
summary(full)
best <- step(full)
summary(best)
#read table/import table
#large scores are good
tox <- read.table("tox.txt", header = TRUE)
head(tox)
str(tox)
#read table/import table
#large scores are good
tox <- read.table("tox.txt", header = TRUE)
baby <- read.table("baby.txt", header = TRUE)
head(baby)
str(baby)
#read data
baby <- read.table("baby.txt", header = TRUE)
head(baby)
str(baby)
bw <- baby[,1]
# Histogram
hist(bw,
main = "Histogram of Baby Birthweights",
xlab = "Birthweight (ounces)",
col = "lightblue",
border = "black")
# Normal Q-Q plot
qqnorm(bw,
main = "Normal Q-Q Plot of Baby Birthweights")
qqline(bw, col = "red")
bw <- baby[,1]
# Histogram
hist(bw,
main = "Histogram of Baby Birthweights",
xlab = "Birthweight (ounces)",
col = "lightblue",
border = "blue")
# Normal Q-Q plot
qqnorm(bw,
main = "Normal Q-Q Plot of Baby Birthweights")
qqline(bw, col = "red")
#read data
baby <- read.table("baby.txt", header = TRUE)
head(baby)
str(baby)
#mothers weight
mw <- baby[,5]
#histogram for mothers weight
hist(mw,
main = "Histogram of Mothers Pregnancy Weights",
xlab = "PregnancyWeight (pounds)",
col = "lightpink",
border = "pink")
#mothers weight
mw <- baby[,5]
#histogram for mothers weight
hist(mw,
main = "Histogram of Mothers Pregnancy Weights",
xlab = "PregnancyWeight (pounds)",
col = "lightpink",
border = "red")
# Normal Q-Q plot
qqnorm(mw,
main = "Normal Q-Q Plot of Baby Birthweights")
qqline(bw, col = "lightpink")
women <- read.table("women.txt", header = TRUE)
head(women)
str(women)
# Fit linear model
linear_model <- lm(avew ~ h, data = women)
# Summary of linear model
summary(linear_model)
# Correlation coefficient
cor(women$h, women$avew)
quad_model <- lm(avew ~ poly(h, 2), data = women)
summary(quad_model)
plot(women$h, women$avew, main="Weight vs Height", xlab="Height (inches)", ylab="Average Weight (lbs)", pch=19)
# Linear regression line
abline(linear_model, col="blue", lwd=2)
# Quadratic fit line
h_seq <- seq(min(women$h), max(women$h), length.out=100)
quad_pred <- predict(quad_model, newdata=data.frame(h=h_seq))
lines(h_seq, quad_pred, col="red", lwd=2)
# Add legend
legend("topleft", legend=c("Linear","Quadratic"), col=c("blue","red"), lwd=2)
